generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma/client"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id              String   @id @default(uuid())
  email           String   @unique
  gameAuthCode    String?  
  lastMatchCode   String? 
  player          Player?  @relation(fields: [playerId], references: [id])
  playerId        String?  @unique
  createdAt       DateTime @default(now())
}
model Player {
  id       String   @id @default(uuid())
  steamId  String   @unique
  user     User?
  stats    PlayerMatchStats[]
}

model Match {
  id          String   @id @default(uuid())
  matchId     String   @unique
  team1Score  Int
  team2Score  Int
  playedAt    DateTime @default(now())
  stats       PlayerMatchStats[]
}

model PlayerMatchStats {
  id                      String   @id @default(uuid())
  playerId                String
  matchId                 String

  steamId                 String
  username                String
  teamNumber              Int
  accuracy                Float
  accuracySpotted         Float
  hsAccuracy              Float
  timeToDamage            Float
  crosshairPlacement      Float
  counterStrafing         Float
  totalKills              Int
  totalDeaths             Int
  openingKills            Int
  tradeKills              Int
  tradeKillPercentage     Float
  tradedDeaths            Int
  tradedDeathPercentage   Float
  multiKillRounds         Int
  multiKillPercentage     Float

  player   Player @relation(fields: [playerId], references: [id])
  match    Match  @relation(fields: [matchId], references: [id])

  @@index([playerId])
  @@index([matchId])
}
